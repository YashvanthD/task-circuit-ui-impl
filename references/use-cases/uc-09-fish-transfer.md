# UC-09: Fish Transfer (Between Ponds)

**Category:** Stock Management  
**Actors:** Farm Manager  
**Precondition:** Source stock active, target pond available

---

## Overview

Moving fish from one pond to another. Source count decreases, target count increases.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           FISH TRANSFER OVERVIEW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  SOURCE POND (A1)                               TARGET POND (B1)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        Transfer           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Stock: 6000     â”‚        2000 fish          â”‚ Stock: 0        â”‚                 â”‚
â”‚  â”‚                 â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º     â”‚ (empty)         â”‚                 â”‚
â”‚  â”‚ ğŸŸğŸŸğŸŸğŸŸğŸŸğŸŸ    â”‚                           â”‚    ğŸŒŠ           â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                                              â”‚                            â”‚
â”‚         â–¼                                              â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Stock: 4000     â”‚                           â”‚ Stock: 2000     â”‚                 â”‚
â”‚  â”‚ (after)         â”‚                           â”‚ (NEW or added)  â”‚                 â”‚
â”‚  â”‚ ğŸŸğŸŸğŸŸğŸŸ        â”‚                           â”‚ ğŸŸğŸŸ            â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Transfer Scenarios

### Scenario A: Transfer to Empty Pond
```
Source: Pond A1 (6000 fish) â†’ Target: Pond B1 (empty)
Result: 
  - Source: 4000 fish remaining
  - Target: NEW STOCK created with 2000 fish
  - Target pond status: "stocked"
```

### Scenario B: Transfer to Stocked Pond (Same Species)
```
Source: Pond A1 (6000 fish) â†’ Target: Pond B1 (1000 fish, same species)
Result:
  - Source: 4000 fish remaining
  - Target: 3000 fish (existing stock +2000)
```

---

## Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TRANSFER FLOW                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  POST /transfers                                                                    â”‚
â”‚  {                                                                                  â”‚
â”‚    source_stock_id,                                                                 â”‚
â”‚    target_pond_id,                                                                  â”‚
â”‚    count: 2000                                                                      â”‚
â”‚  }                                                                                  â”‚
â”‚       â”‚                                                                              â”‚
â”‚       â–¼                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ VALIDATION                                                                    â”‚   â”‚
â”‚  â”‚ â€¢ Source stock active?                                                       â”‚   â”‚
â”‚  â”‚ â€¢ count <= source.current_count?                                             â”‚   â”‚
â”‚  â”‚ â€¢ Target pond exists?                                                        â”‚   â”‚
â”‚  â”‚ â€¢ If target has stock: same species?                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                                              â”‚
â”‚       â–¼                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ UPDATE SOURCE              â”‚ UPDATE/CREATE TARGET       â”‚                       â”‚
â”‚  â”‚                            â”‚                            â”‚                       â”‚
â”‚  â”‚ current_count -= 2000      â”‚ If empty pond:             â”‚                       â”‚
â”‚  â”‚ transfer_out_count += 2000 â”‚   CREATE new stock         â”‚                       â”‚
â”‚  â”‚                            â”‚   Pond status = "stocked"  â”‚                       â”‚
â”‚  â”‚ If count = 0:              â”‚                            â”‚                       â”‚
â”‚  â”‚   status = "transferred"   â”‚ If existing stock:         â”‚                       â”‚
â”‚  â”‚   Pond status = "empty"    â”‚   current_count += 2000    â”‚                       â”‚
â”‚  â”‚                            â”‚   transfer_in_count += 2000â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Request

```http
POST /api/fish/transfers
Content-Type: application/json

{
  "source_stock_id": "444444444444",
  "target_pond_id": "555555555555",
  "count": 2000,
  "transfer_date": "2026-02-20",
  "reason": "overcrowding",
  "notes": "Moving larger fish to grow-out pond"
}
```

---

## Collections Affected

| Collection | Action | Details |
|------------|--------|---------|
| transfers | INSERT | New transfer record |
| stocks (source) | UPDATE | current_count -2000, transfer_out_count +2000 |
| stocks (target) | INSERT/UPDATE | New stock or current_count +2000 |
| ponds (source) | UPDATE (if empty) | status="empty" if all transferred |
| ponds (target) | UPDATE | status="stocked", current_stock_id |
| activity_logs | INSERT | 2+ records (source removed, target added) |

---

## Acceptance Criteria

- [ ] Transfer record created
- [ ] Source stock count decreases
- [ ] Target stock created or count increases
- [ ] Pond statuses updated correctly
- [ ] Activity logs on both ponds
- [ ] Cannot transfer more than available
- [ ] Cannot transfer to pond with different species

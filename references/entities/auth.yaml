# Authentication Entity Schemas
# Represents authentication-related entities

LoginRequest:
  type: object
  required:
    - email
    - password
  properties:
    email:
      type: string
      format: email
      description: User's email address
      example: "user@example.com"
    password:
      type: string
      format: password
      description: User's password
      example: "password123"

RegisterRequest:
  type: object
  required:
    - email
    - password
    - name
  properties:
    email:
      type: string
      format: email
      description: User's email address
      example: "user@example.com"
    password:
      type: string
      format: password
      description: User's password
      example: "password123"
    name:
      type: string
      description: User's full name
      example: "John Doe"
    organization_name:
      type: string
      description: Name of the organization (optional)
      example: "My Farm"

AuthResponse:
  type: object
  properties:
    access_token:
      type: string
      description: JWT access token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    refresh_token:
      type: string
      description: JWT refresh token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    user_key:
      type: string
      description: User's unique identifier
      example: "123456789"
    account_key:
      type: string
      description: Account's unique identifier
      example: "987654321"
    expires_in:
      type: integer
      description: Token expiration time in seconds
      example: 604800
    user:
      $ref: './user.yaml#/User'
    account:
      $ref: './company.yaml#/Company'

TokenValidateResponse:
  type: object
  properties:
    valid:
      type: boolean
      description: Whether the token is valid
      example: true
    payload:
      type: object
      properties:
        user_key:
          type: string
          example: "123456789"
        account_key:
          type: string
          example: "987654321"
        role:
          type: string
          example: "owner"

RefreshTokenRequest:
  type: object
  required:
    - refresh_token
  properties:
    refresh_token:
      type: string
      description: Refresh token
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

ChangePasswordRequest:
  type: object
  required:
    - current_password
    - new_password
  properties:
    current_password:
      type: string
      format: password
      description: Current password
      example: "oldpass123"
    new_password:
      type: string
      format: password
      description: New password
      example: "newpass123"

ForgotPasswordRequest:
  type: object
  required:
    - email
  properties:
    email:
      type: string
      format: email
      description: User's email address
      example: "user@example.com"

ResetPasswordRequest:
  type: object
  required:
    - token
    - new_password
  properties:
    token:
      type: string
      description: Password reset token
      example: "reset_token_here"
    new_password:
      type: string
      format: password
      description: New password
      example: "newpass123"

TokenInfo:
  type: object
  properties:
    user_key:
      type: string
      example: "123456789"
    account_key:
      type: string
      example: "987654321"
    role:
      type: string
      example: "owner"
    issued_at:
      type: string
      format: date-time
      example: "2024-01-30T10:00:00Z"
    expires_at:
      type: string
      format: date-time
      example: "2024-02-06T10:00:00Z"

Session:
  type: object
  properties:
    session_key:
      type: string
      description: Unique session identifier
      example: "sess_abc123"
    device:
      type: string
      description: Device information
      example: "Chrome on Windows"
    ip_address:
      type: string
      description: IP address
      example: "192.168.1.1"
    last_active:
      type: string
      format: date-time
      description: Last activity timestamp
      example: "2024-01-30T10:00:00Z"
    is_current:
      type: boolean
      description: Whether this is the current session
      example: true
    created_at:
      type: string
      format: date-time
      description: Session creation timestamp
      example: "2024-01-30T10:00:00Z"
